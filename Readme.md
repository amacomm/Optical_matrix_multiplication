# Оптическая операция умножения матрицы на вектора
## Подготовка
1. Создаётся объект конфигурации оптической установки `Config`, содержащий все параметры модели системы оптического матричного умножения.
Особое внимание уделяется размеру вычислительной области `array_size`, размеру вектора `vector_size` внутри оптической установки, а также коэффициенту масштабирования `scale_by_x`: параметры позволяют настроить желаемую точности результата и скорость вычисления.
3. Задаётся оператор распространения световых волн в свободном пространстве (в данном случае задан `Propagator_sinc_operator` в виду его наибольшей точности), и объект пропагатора `Propagator`.
4. Создаётся объект системы оптического умножения матрицы на вектор `OpticalMul`.
```python
config = source.Config(scale_by_x = 2,
                       vector_size = 16)

propagator_operator = propagator.Propagator_sinc_operator()
prop = propagator.Propagator(operator = propagator_operator,
                  config = config)
mul = source.OpticalMul(prop, config)
```
## Принип использования
Созданному объекту системы подаётся на вход два тензора: тензор левой матрицы (B, C, H, W) и тензор правой вектора (B, C, W, K) на выходе получается тензор размерностью (B, C, H, K).
```python
matrix = torch.rand((1, 1, 128, 256)) > 0.5
vector = torch.rand((1, 1, 256, 64)) > 0.5
mul(matrix, vector).shape
# torch.Size([1, 1, 128, 64])
```
## Нововведения
- Добавлена возможность умножения на комплексные матрицы.
- Добален класс распределенных вычислений `DataParallel`, на множестве видеокарт.