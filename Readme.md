# Оптическая операция умножения матрицы на вектора
## Подготовка
1. Создатся объект конфигурации оптической установки `Config` содержащий все параметры модели системы оптического умножения матрицы на вектор. Особое внимание уделяется размеру вычислительной области `array_size` и размеру вектора `vector_size` внутри оптической установки: параметры позволяют настроить желаемую точности результата и скорость вычисления.
2. Задаётся оператор распространения световых волн в свободном пространстве (в данном случае задан `Propagator_sinc_operator` в виду его наибольшей точности), и объект пропагатора `Propagator`.
3. Создаётся объект системы оптического умножения матрицы на вектор `OpticalMul`.
```python
config = source.Config(array_size = 4096 * 2,
                       vector_size = 256 * 2,
                       device = torch.device('cuda'))

propagator_operator = propagator.Propagator_sinc_operator()
prop = propagator.Propagator(operator = propagator_operator,
                  config = config)
mul = source.OpticalMul(prop, config)
```
## Принип использования
Созданному объекту системы подаётся на вход два тензора: тензор матрицы (N, C, H, W) и тензор вектора (N, C, L) на выходе получается тензор вектор размерностью (N, C, H).
```python
matrix = torch.rand((1, 1, 128, 256)) > 0.5
vector = torch.rand((3, 1, 256)) > 0.5
mul(matrix, vector).shape
# torch.Size([3, 1, 128])
```